<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <title>Spinnaker Managed: DeviceEvents_CSharp.cs</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <script type="text/javascript" src="ga.js"></script>
  <link href="stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
  <div id="top"><!-- do not remove this div! -->
  <div id="titlearea">
    <table cellspacing="0" cellpadding="0.9em" width="100%">
      <tbody>
        <tr style="height: 56px;">
          <td id="projectlogo" style="padding-left: 0.9em;text-align: left;background: #ffffff;background: linear-gradient(#002f86, #ffffff);color: #ffffff;" width="30%"><a href="https://www.flir.com/iis/machine-vision"><img alt="Logo" src="FLIR_Logo.png"/></a></td>
          <td style="padding-left: 0.5em;text-align: left;background: #002f86;background: linear-gradient(#002f86, #ffffff);color: #ffffff;" width="30%"><div id="projectname">Spinnaker Managed</div></td>
          <td style="padding-right: 0.9em;text-align: right;background: #002f86;background: linear-gradient(#002f86, #ffffff);color: #ffffff;" width="30%"><div id="projectname"><span id="projectnumber">2.0.0.0</span></td>
        </tr>
      </tbody>
    </table>
  </div>
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">DeviceEvents_CSharp.cs</div>  </div>
</div><!--header-->
<div class="contents">
<p>DeviceEvents_CSharp.cs shows how to create a handler to access device events. It relies on information provided in the <a class="el" href="namespace_enumeration___c_sharp.html">Enumeration_CSharp</a>, <a class="el" href="namespace_acquisition___c_sharp.html">Acquisition_CSharp</a>, and <a class="el" href="namespace_node_map_info___c_sharp.html">NodeMapInfo_CSharp</a> examples. </p>
<pre class="fragment">It can also be helpful to familiarize yourself with the
</pre><p> <a class="el" href="namespace_node_map_callback___c_sharp.html">NodeMapCallback_CSharp</a> example, as callbacks follow the same general procedure as events, but with a few less steps. </p>
<pre class="fragment">Device events can be thought of as camera-related events. This example
creates a user-defined class, DeviceEventHandler, that inherits from the
Spinnaker C# class, ManagedDeviceEventHandler. DeviceEventHandler, the child class,
</pre><p> allows the user to define any properties, parameters, and the event itself while ManagedDeviceEventHandler, the parent class, allows the child class to appropriately interface with the C# Spinnaker SDK.</p>
<div class="fragment"><div class="line"><span class="comment">//=============================================================================</span></div>
<div class="line"><span class="comment">// Copyright (c) 2001-2019 FLIR Systems, Inc. All Rights Reserved.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// This software is the confidential and proprietary information of FLIR</span></div>
<div class="line"><span class="comment">// Integrated Imaging Solutions, Inc. (&quot;Confidential Information&quot;). You</span></div>
<div class="line"><span class="comment">// shall not disclose such Confidential Information and shall use it only in</span></div>
<div class="line"><span class="comment">// accordance with the terms of the license agreement you entered into</span></div>
<div class="line"><span class="comment">// with FLIR Integrated Imaging Solutions, Inc. (FLIR).</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// FLIR MAKES NO REPRESENTATIONS OR WARRANTIES ABOUT THE SUITABILITY OF THE</span></div>
<div class="line"><span class="comment">// SOFTWARE, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE</span></div>
<div class="line"><span class="comment">// IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR</span></div>
<div class="line"><span class="comment">// PURPOSE, OR NON-INFRINGEMENT. FLIR SHALL NOT BE LIABLE FOR ANY DAMAGES</span></div>
<div class="line"><span class="comment">// SUFFERED BY LICENSEE AS A RESULT OF USING, MODIFYING OR DISTRIBUTING</span></div>
<div class="line"><span class="comment">// THIS SOFTWARE OR ITS DERIVATIVES.</span></div>
<div class="line"><span class="comment">//=============================================================================</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">using</span> System;</div>
<div class="line"><span class="keyword">using</span> System.IO;</div>
<div class="line"><span class="keyword">using</span> System.Collections.Generic;</div>
<div class="line"><span class="keyword">using</span> SpinnakerNET;</div>
<div class="line"><span class="keyword">using</span> SpinnakerNET.GenApi;</div>
<div class="line"></div>
<div class="line"><span class="keyword">namespace </span>DeviceEvents_CSharp</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">class </span>Program</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Use the following enum and global static variable to select whether</span></div>
<div class="line">        <span class="comment">// device events will be registered universally to all events or</span></div>
<div class="line">        <span class="comment">// specifically to exposure end events.</span></div>
<div class="line">        <span class="keyword">enum</span> eventType</div>
<div class="line">        {</div>
<div class="line">            <a name="a0"></a><a class="code" href="class_device_events___c_sharp_1_1_program.html#a3017adf344c435005db11e8c0d8c03bda8045a0a6c688b0635e3caccc408a1446">Generic</a>,</div>
<div class="line">            <a name="a1"></a><a class="code" href="class_device_events___c_sharp_1_1_program.html#a3017adf344c435005db11e8c0d8c03bdafe0619d5f4999e09c622e32da7e7566a">Specific</a></div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">static</span> eventType chosenEvent = eventType.Generic;</div>
<div class="line"></div>
<div class="line">        <span class="comment">// This class defines the properties, parameters, and the event handler itself.</span></div>
<div class="line">        <span class="comment">// Take a moment to notice what parts of the class are mandatory, and</span></div>
<div class="line">        <span class="comment">// what have been added for demonstration purposes. First, any class</span></div>
<div class="line">        <span class="comment">// used to define device events must inherit from DeviceEvent. Second,</span></div>
<div class="line">        <span class="comment">// the method signature of OnDeviceEvent() must also be consistent.</span></div>
<div class="line">        <span class="comment">// Everything else - including the constructor, properties, and body of</span></div>
<div class="line">        <span class="comment">// OnDeviceEvent() - are particular to the example.</span></div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">class </span>DeviceEventListener : ManagedDeviceEventHandler</div>
<div class="line">        {</div>
<div class="line">            <span class="keyword">private</span> <span class="keywordtype">string</span> specificEvent;</div>
<div class="line">            <span class="keyword">private</span> <span class="keywordtype">int</span> count;</div>
<div class="line"></div>
<div class="line">            <span class="comment">// This constructor registers an event name to be used on device</span></div>
<div class="line">            <span class="comment">// events.</span></div>
<div class="line">            <span class="keyword">public</span> <a name="a2"></a><a class="code" href="class_device_events___c_sharp_1_1_program_1_1_device_event_listener.html#ab24cffd223596c5618260f20a89e2f6e">DeviceEventListener</a>(<span class="keywordtype">string</span> eventName)</div>
<div class="line">            {</div>
<div class="line">                specificEvent = eventName;</div>
<div class="line">                count = 0;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="comment">// This method is designed to demonstrate the difference between</span></div>
<div class="line">            <span class="comment">// registering all device events generally versus registering only a</span></div>
<div class="line">            <span class="comment">// specific device event. If registered specifically, the else-block</span></div>
<div class="line">            <span class="comment">// will never run because only the specific event will call this</span></div>
<div class="line">            <span class="comment">// method.</span></div>
<div class="line">            <span class="keyword">protected</span> <span class="keyword">override</span> <span class="keywordtype">void</span> <a name="a3"></a><a class="code" href="class_device_events___c_sharp_1_1_program_1_1_device_event_listener.html#a2d13c2270c7af56094e9433609ca0dfa">OnDeviceEvent</a>(<span class="keywordtype">string</span> eventName)</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// Check that device event is registered</span></div>
<div class="line">                <span class="keywordflow">if</span> (eventName == specificEvent)</div>
<div class="line">                {</div>
<div class="line">                    <span class="comment">// Print information on specified device event</span></div>
<div class="line">                    Console.WriteLine(</div>
<div class="line">                        <span class="stringliteral">&quot;\tDevice event {0} with ID {1} number {2}...&quot;</span>,</div>
<div class="line">                        GetDeviceEventName(),</div>
<div class="line">                        GetDeviceEventID(),</div>
<div class="line">                        ++count);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                    <span class="comment">// Print no information on non-specified information</span></div>
<div class="line">                    Console.WriteLine(<span class="stringliteral">&quot;\tDevice event occurred; not {0}; ignoring...&quot;</span>, specificEvent);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">// This function configures the example to execute device events by</span></div>
<div class="line">        <span class="comment">// enabling all types of device events, and then creating and registering</span></div>
<div class="line">        <span class="comment">// a device event that only concerns itself with an end of exposure event.</span></div>
<div class="line">        <span class="keywordtype">int</span> ConfigureDeviceEvents(INodeMap nodeMap, IManagedCamera cam, ref DeviceEventListener deviceEventListener)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">int</span> result = 0;</div>
<div class="line"></div>
<div class="line">            Console.WriteLine(<span class="stringliteral">&quot;\n\n**** CONFIGURING DEVICE EVENTS***\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                <span class="comment">//</span></div>
<div class="line">                <span class="comment">// Retrieve device event selector</span></div>
<div class="line">                <span class="comment">//</span></div>
<div class="line">                <span class="comment">// *** NOTES ***</span></div>
<div class="line">                <span class="comment">// Each type of device event must be enabled individually. This</span></div>
<div class="line">                <span class="comment">// is done by retrieving &quot;EventSelector&quot; (an enumeration node)</span></div>
<div class="line">                <span class="comment">// and then enabling the device event on &quot;EventNotification&quot;</span></div>
<div class="line">                <span class="comment">// (another enumeration node).</span></div>
<div class="line">                <span class="comment">//</span></div>
<div class="line">                <span class="comment">// This example only deals with exposure end events. However,</span></div>
<div class="line">                <span class="comment">// instead of only enabling exposure end events with a simpler</span></div>
<div class="line">                <span class="comment">// device event function, all device events are enabled while</span></div>
<div class="line">                <span class="comment">// the device event handler deals with ensuring that only</span></div>
<div class="line">                <span class="comment">// exposure end events are considered. A more standard use-case</span></div>
<div class="line">                <span class="comment">// might be to enable only the events of interest.</span></div>
<div class="line">                <span class="comment">//</span></div>
<div class="line">                IEnum iEventSelector = nodeMap.GetNode&lt;IEnum&gt;(<span class="stringliteral">&quot;EventSelector&quot;</span>);</div>
<div class="line">                <span class="keywordflow">if</span> (iEventSelector == null || !iEventSelector.IsReadable)</div>
<div class="line">                {</div>
<div class="line">                    Console.WriteLine(<span class="stringliteral">&quot;Unable to fetch event enumeration entries. Aborting...&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">return</span> -1;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                var entries = iEventSelector.Entries;</div>
<div class="line"></div>
<div class="line">                Console.WriteLine(<span class="stringliteral">&quot;Enabling event selector entries...&quot;</span>);</div>
<div class="line"></div>
<div class="line">                <span class="comment">//</span></div>
<div class="line">                <span class="comment">// Enable device events</span></div>
<div class="line">                <span class="comment">//</span></div>
<div class="line">                <span class="comment">// *** NOTES ***</span></div>
<div class="line">                <span class="comment">// In order to enable a device event, the event selector and</span></div>
<div class="line">                <span class="comment">// event notification nodes (both of type enumeration) must work</span></div>
<div class="line">                <span class="comment">// in unison. The desired event must first be selected on the</span></div>
<div class="line">                <span class="comment">// event selector node and then enabled on the event</span></div>
<div class="line">                <span class="comment">// notification node.</span></div>
<div class="line">                <span class="comment">//</span></div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; entries.Length; i++)</div>
<div class="line">                {</div>
<div class="line">                    <span class="comment">// Select entry on selector node</span></div>
<div class="line">                    IEnumEntry iEnumEntry = entries[i];</div>
<div class="line">                    <span class="keywordflow">if</span> (!iEnumEntry.IsAvailable || !iEnumEntry.IsReadable)</div>
<div class="line">                    {</div>
<div class="line">                        <span class="comment">// Skip if node fails</span></div>
<div class="line">                        result = -1;</div>
<div class="line">                        <span class="keywordflow">continue</span>;</div>
<div class="line">                    }</div>
<div class="line"></div>
<div class="line">                    <span class="keywordflow">if</span> (!iEventSelector.IsWritable)</div>
<div class="line">                    {</div>
<div class="line">                        Console.WriteLine(<span class="stringliteral">&quot;Unable to write to event selector node. Aborting...&quot;</span>);</div>
<div class="line">                        <span class="keywordflow">return</span> -1;</div>
<div class="line">                    }</div>
<div class="line"></div>
<div class="line">                    iEventSelector.Value = iEnumEntry.Value;</div>
<div class="line"></div>
<div class="line">                    <span class="comment">// Retrieve event notification node (an enumeration node)</span></div>
<div class="line">                    IEnum iEventNotification = nodeMap.GetNode&lt;IEnum&gt;(<span class="stringliteral">&quot;EventNotification&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">if</span> (iEventNotification == null || !iEventNotification.IsWritable)</div>
<div class="line">                    {</div>
<div class="line">                        <span class="comment">// Skip if node fails</span></div>
<div class="line">                        result = -1;</div>
<div class="line">                        <span class="keywordflow">continue</span>;</div>
<div class="line">                    }</div>
<div class="line"></div>
<div class="line">                    <span class="comment">// Retrieve entry node to enable device event</span></div>
<div class="line">                    IEnumEntry iEventNotificationOn = iEventNotification.GetEntryByName(<span class="stringliteral">&quot;On&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">if</span> (iEventNotificationOn == null || !iEventNotification.IsReadable)</div>
<div class="line">                    {</div>
<div class="line">                        <span class="comment">// Skip if node fails</span></div>
<div class="line">                        result = -1;</div>
<div class="line">                        <span class="keywordflow">continue</span>;</div>
<div class="line">                    }</div>
<div class="line"></div>
<div class="line">                    iEventNotification.Value = iEventNotificationOn.Value;</div>
<div class="line"></div>
<div class="line">                    Console.WriteLine(<span class="stringliteral">&quot;\t{0}: enabled...&quot;</span>, iEnumEntry.DisplayName);</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="comment">//</span></div>
<div class="line">                <span class="comment">// Create device event handler</span></div>
<div class="line">                <span class="comment">//</span></div>
<div class="line">                <span class="comment">// *** NOTES ***</span></div>
<div class="line">                <span class="comment">// The class has been designed to take in the name of an event.</span></div>
<div class="line">                <span class="comment">// If all event handlers are registered generically, all event types</span></div>
<div class="line">                <span class="comment">// will trigger a device event; on the other hand, if an event</span></div>
<div class="line">                <span class="comment">// is registered specifically, only that event will trigger an</span></div>
<div class="line">                <span class="comment">// event.</span></div>
<div class="line">                <span class="comment">//</span></div>
<div class="line">                deviceEventListener = <span class="keyword">new</span> DeviceEventListener(<span class="stringliteral">&quot;EventExposureEnd&quot;</span>);</div>
<div class="line"></div>
<div class="line">                <span class="comment">//</span></div>
<div class="line">                <span class="comment">// Register device event handler</span></div>
<div class="line">                <span class="comment">//</span></div>
<div class="line">                <span class="comment">// *** NOTES ***</span></div>
<div class="line">                <span class="comment">// Device events are registered to cameras. If there are multiple</span></div>
<div class="line">                <span class="comment">// cameras, each camera must have any device event handlers registered to</span></div>
<div class="line">                <span class="comment">// it separately. Also, multiple device event handlers may be registered</span></div>
<div class="line">                <span class="comment">// to a single camera.</span></div>
<div class="line">                <span class="comment">//</span></div>
<div class="line">                <span class="comment">// *** LATER ***</span></div>
<div class="line">                <span class="comment">// Device event handlers need to be unregistered manually. This must be</span></div>
<div class="line">                <span class="comment">// done prior to releasing the system and while the device events</span></div>
<div class="line">                <span class="comment">// are still in scope.</span></div>
<div class="line">                <span class="comment">//</span></div>
<div class="line">                <span class="keywordflow">if</span> (chosenEvent == eventType.Generic)</div>
<div class="line">                {</div>
<div class="line">                    <span class="comment">// Device event listeners registered generally will be</span></div>
<div class="line">                    <span class="comment">// triggered by any device events.</span></div>
<div class="line">                    cam.RegisterEventHandler(deviceEventListener);</div>
<div class="line"></div>
<div class="line">                    Console.WriteLine(<span class="stringliteral">&quot;Device event listener registered generally...&quot;</span>);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (chosenEvent == eventType.Specific)</div>
<div class="line">                {</div>
<div class="line">                    <span class="comment">// Device event listeners registered to a specific event</span></div>
<div class="line">                    <span class="comment">// will only be triggered by the type of event that is</span></div>
<div class="line">                    <span class="comment">// registered.</span></div>
<div class="line">                    cam.RegisterEventHandler(deviceEventListener, <span class="stringliteral">&quot;EventExposureEnd&quot;</span>);</div>
<div class="line"></div>
<div class="line">                    Console.WriteLine(<span class="stringliteral">&quot;Device event listener registered specifically to EventExposureEnd events...&quot;</span>);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (SpinnakerException ex)</div>
<div class="line">            {</div>
<div class="line">                Console.WriteLine(<span class="stringliteral">&quot;Error: {0}&quot;</span>, ex.Message);</div>
<div class="line">                result = -1;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">return</span> result;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">// This function resets the example by unregistering the device event.</span></div>
<div class="line">        <span class="keywordtype">int</span> ResetDeviceEvents(IManagedCamera cam, ref DeviceEventListener deviceEventListener)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">int</span> result = 0;</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                <span class="comment">//</span></div>
<div class="line">                <span class="comment">// Unregister device event handler</span></div>
<div class="line">                <span class="comment">//</span></div>
<div class="line">                <span class="comment">// *** NOTES ***</span></div>
<div class="line">                <span class="comment">// It is important to unregister all device event handlers from all</span></div>
<div class="line">                <span class="comment">// cameras that they are registered to.</span></div>
<div class="line">                <span class="comment">//</span></div>
<div class="line">                cam.UnregisterEventHandler(deviceEventListener);</div>
<div class="line"></div>
<div class="line">                Console.WriteLine(<span class="stringliteral">&quot;Device event listener unregistered...\n&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (SpinnakerException ex)</div>
<div class="line">            {</div>
<div class="line">                Console.WriteLine(<span class="stringliteral">&quot;Error: {0}&quot;</span>, ex.Message);</div>
<div class="line">                result = -1;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">return</span> result;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">// This function prints the device information of the camera from the</span></div>
<div class="line">        <span class="comment">// transport layer; please see NodeMapInfo_CSharp example for more</span></div>
<div class="line">        <span class="comment">// in-depth comments on printing device information from the nodemap.</span></div>
<div class="line">        <span class="keyword">static</span> <span class="keywordtype">int</span> PrintDeviceInfo(INodeMap nodeMap)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">int</span> result = 0;</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                Console.WriteLine(<span class="stringliteral">&quot;\n*** DEVICE INFORMATION ***\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">                ICategory category = nodeMap.GetNode&lt;ICategory&gt;(<span class="stringliteral">&quot;DeviceInformation&quot;</span>);</div>
<div class="line">                <span class="keywordflow">if</span> (category != null &amp;&amp; category.IsReadable)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; category.Children.Length; i++)</div>
<div class="line">                    {</div>
<div class="line">                        Console.WriteLine(</div>
<div class="line">                            <span class="stringliteral">&quot;{0}: {1}&quot;</span>,</div>
<div class="line">                            category.Children[i].Name,</div>
<div class="line">                            (category.Children[i].IsReadable ? category.Children[i].ToString()</div>
<div class="line">                             : <span class="stringliteral">&quot;Node not available&quot;</span>));</div>
<div class="line">                    }</div>
<div class="line">                    Console.WriteLine();</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                    Console.WriteLine(<span class="stringliteral">&quot;Device control information not available.&quot;</span>);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (SpinnakerException ex)</div>
<div class="line">            {</div>
<div class="line">                Console.WriteLine(<span class="stringliteral">&quot;Error: {0}&quot;</span>, ex.Message);</div>
<div class="line">                result = -1;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">return</span> result;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">// This function acquires and saves 10 images from a device; please see</span></div>
<div class="line">        <span class="comment">// Acquisition_CSharp example for more in-depth comments on the</span></div>
<div class="line">        <span class="comment">// acquisition of images.</span></div>
<div class="line">        <span class="keyword">static</span> <span class="keywordtype">int</span> AcquireImages(IManagedCamera cam, INodeMap nodeMap, INodeMap nodeMapTLDevice)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">int</span> result = 0;</div>
<div class="line"></div>
<div class="line">            Console.WriteLine(<span class="stringliteral">&quot;\n*** IMAGE ACQUISITION ***\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// Set acquisition mode to continuous</span></div>
<div class="line">                IEnum iAcquisitionMode = nodeMap.GetNode&lt;IEnum&gt;(<span class="stringliteral">&quot;AcquisitionMode&quot;</span>);</div>
<div class="line">                <span class="keywordflow">if</span> (iAcquisitionMode == null || !iAcquisitionMode.IsWritable)</div>
<div class="line">                {</div>
<div class="line">                    Console.WriteLine(<span class="stringliteral">&quot;Unable to set acquisition mode to continuous (node retrieval). Aborting...\n&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">return</span> -1;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                IEnumEntry iAcquisitionModeContinuous = iAcquisitionMode.GetEntryByName(<span class="stringliteral">&quot;Continuous&quot;</span>);</div>
<div class="line">                <span class="keywordflow">if</span> (iAcquisitionModeContinuous == null || !iAcquisitionMode.IsReadable)</div>
<div class="line">                {</div>
<div class="line">                    Console.WriteLine(</div>
<div class="line">                        <span class="stringliteral">&quot;Unable to set acquisition mode to continuous (enum entry retrieval). Aborting...\n&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">return</span> -1;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                iAcquisitionMode.Value = iAcquisitionModeContinuous.Symbolic;</div>
<div class="line"></div>
<div class="line">                Console.WriteLine(<span class="stringliteral">&quot;Acquisition mode set to continuous...&quot;</span>);</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Begin acquiring images</span></div>
<div class="line">                cam.BeginAcquisition();</div>
<div class="line"></div>
<div class="line">                Console.WriteLine(<span class="stringliteral">&quot;Acquiring images...&quot;</span>);</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Retrieve device serial number for filename</span></div>
<div class="line">                String deviceSerialNumber = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"></div>
<div class="line">                IString iDeviceSerialNumber = nodeMapTLDevice.GetNode&lt;IString&gt;(<span class="stringliteral">&quot;DeviceSerialNumber&quot;</span>);</div>
<div class="line">                <span class="keywordflow">if</span> (iDeviceSerialNumber != null &amp;&amp; iDeviceSerialNumber.IsReadable)</div>
<div class="line">                {</div>
<div class="line">                    deviceSerialNumber = iDeviceSerialNumber.Value;</div>
<div class="line"></div>
<div class="line">                    Console.WriteLine(<span class="stringliteral">&quot;Device serial number retrieved as {0}...&quot;</span>, deviceSerialNumber);</div>
<div class="line">                }</div>
<div class="line">                Console.WriteLine();</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Retrieve, convert, and save images</span></div>
<div class="line">                <span class="keyword">const</span> <span class="keywordtype">int</span> NumImages = 10;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> imageCnt = 0; imageCnt &lt; NumImages; imageCnt++)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">try</span></div>
<div class="line">                    {</div>
<div class="line">                        <span class="comment">// Retrieve next received image and ensure image completion</span></div>
<div class="line">                        <span class="keyword">using</span>(IManagedImage rawImage = cam.GetNextImage(1000))</div>
<div class="line">                        {</div>
<div class="line">                            <span class="keywordflow">if</span> (rawImage.IsIncomplete)</div>
<div class="line">                            {</div>
<div class="line">                                Console.WriteLine(<span class="stringliteral">&quot;Image incomplete with image status {0}...&quot;</span>, rawImage.ImageStatus);</div>
<div class="line">                            }</div>
<div class="line">                            <span class="keywordflow">else</span></div>
<div class="line">                            {</div>
<div class="line">                                <span class="comment">// Print image information</span></div>
<div class="line">                                Console.WriteLine(</div>
<div class="line">                                    <span class="stringliteral">&quot;Grabbed image {0}, width = {1}, height = {1}&quot;</span>,</div>
<div class="line">                                    imageCnt,</div>
<div class="line">                                    rawImage.Width,</div>
<div class="line">                                    rawImage.Height);</div>
<div class="line"></div>
<div class="line">                                <span class="comment">// Convert image to mono 8</span></div>
<div class="line">                                <span class="keyword">using</span>(IManagedImage convertedImage = rawImage.Convert(PixelFormatEnums.Mono8))</div>
<div class="line">                                {</div>
<div class="line">                                    <span class="comment">// Create unique file name</span></div>
<div class="line">                                    String filename = <span class="stringliteral">&quot;DeviceEvents-CSharp-&quot;</span>;</div>
<div class="line">                                    <span class="keywordflow">if</span> (deviceSerialNumber != <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line">                                    {</div>
<div class="line">                                        filename = filename + deviceSerialNumber + <span class="stringliteral">&quot;-&quot;</span>;</div>
<div class="line">                                    }</div>
<div class="line">                                    filename = filename + imageCnt + <span class="stringliteral">&quot;.jpg&quot;</span>;</div>
<div class="line"></div>
<div class="line">                                    <span class="comment">// Save image</span></div>
<div class="line">                                    convertedImage.Save(filename);</div>
<div class="line"></div>
<div class="line">                                    Console.WriteLine(<span class="stringliteral">&quot;Image saved at {0}\n&quot;</span>, filename);</div>
<div class="line">                                }</div>
<div class="line">                            }</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">catch</span> (SpinnakerException ex)</div>
<div class="line">                    {</div>
<div class="line">                        Console.WriteLine(<span class="stringliteral">&quot;Error: {0}&quot;</span>, ex.Message);</div>
<div class="line">                        result = -1;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="comment">// End acquisition</span></div>
<div class="line">                cam.EndAcquisition();</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (SpinnakerException ex)</div>
<div class="line">            {</div>
<div class="line">                Console.WriteLine(<span class="stringliteral">&quot;Error: {0}&quot;</span>, ex.Message);</div>
<div class="line">                result = -1;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">return</span> result;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">// This function acts as the body of the example; please see</span></div>
<div class="line">        <span class="comment">// NodeMapInfo_CSharp example for more in-depth comments on setting up</span></div>
<div class="line">        <span class="comment">// cameras.</span></div>
<div class="line">        <span class="keywordtype">int</span> RunSingleCamera(IManagedCamera cam)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">int</span> result = 0;</div>
<div class="line">            <span class="keywordtype">int</span> err = 0;</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// Retrieve TL device nodemap and print device information</span></div>
<div class="line">                INodeMap nodeMapTLDevice = cam.GetTLDeviceNodeMap();</div>
<div class="line"></div>
<div class="line">                result = PrintDeviceInfo(nodeMapTLDevice);</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Initialize camera</span></div>
<div class="line">                cam.Init();</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Retrieve GenICam nodemap</span></div>
<div class="line">                INodeMap nodeMap = cam.GetNodeMap();</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Configure device events</span></div>
<div class="line">                DeviceEventListener deviceEventListener = null;</div>
<div class="line"></div>
<div class="line">                err = ConfigureDeviceEvents(nodeMap, cam, ref deviceEventListener);</div>
<div class="line">                <span class="keywordflow">if</span> (err &lt; 0)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">return</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Acquire images</span></div>
<div class="line">                result = result | AcquireImages(cam, nodeMap, nodeMapTLDevice);</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Reset device events</span></div>
<div class="line">                result = result | ResetDeviceEvents(cam, ref deviceEventListener);</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Deinitialize camera</span></div>
<div class="line">                cam.DeInit();</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (SpinnakerException ex)</div>
<div class="line">            {</div>
<div class="line">                Console.WriteLine(<span class="stringliteral">&quot;Error: {0}&quot;</span>, ex.Message);</div>
<div class="line">                result = -1;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">return</span> result;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Example entry point; please see Enumeration_CSharp example for more</span></div>
<div class="line">        <span class="comment">// in-depth comments on preparing and cleaning up the system.</span></div>
<div class="line">        <span class="keyword">static</span> <span class="keywordtype">int</span> Main(<span class="keywordtype">string</span>[] args)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">int</span> result = 0;</div>
<div class="line"></div>
<div class="line">            Program program = <span class="keyword">new</span> Program();</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Since this application saves images in the current folder</span></div>
<div class="line">            <span class="comment">// we must ensure that we have permission to write to this folder.</span></div>
<div class="line">            <span class="comment">// If we do not have permission, fail right away.</span></div>
<div class="line">            FileStream fileStream;</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                fileStream = <span class="keyword">new</span> FileStream(<span class="stringliteral">@&quot;test.txt&quot;</span>, FileMode.Create);</div>
<div class="line">                fileStream.Close();</div>
<div class="line">                File.Delete(<span class="stringliteral">&quot;test.txt&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span></div>
<div class="line">            {</div>
<div class="line">                Console.WriteLine(<span class="stringliteral">&quot;Failed to create file in current folder. Please check permissions.&quot;</span>);</div>
<div class="line">                Console.WriteLine(<span class="stringliteral">&quot;Press enter to exit...&quot;</span>);</div>
<div class="line">                Console.ReadLine();</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Retrieve singleton reference to system object</span></div>
<div class="line">            ManagedSystem system = <span class="keyword">new</span> ManagedSystem();</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Print out current library version</span></div>
<div class="line">            LibraryVersion spinVersion = system.GetLibraryVersion();</div>
<div class="line">            Console.WriteLine(</div>
<div class="line">                <span class="stringliteral">&quot;Spinnaker library version: {0}.{1}.{2}.{3}\n\n&quot;</span>,</div>
<div class="line">                spinVersion.major,</div>
<div class="line">                spinVersion.minor,</div>
<div class="line">                spinVersion.type,</div>
<div class="line">                spinVersion.build);</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Retrieve list of cameras from the system</span></div>
<div class="line">            ManagedCameraList camList = system.GetCameras();</div>
<div class="line"></div>
<div class="line">            Console.WriteLine(<span class="stringliteral">&quot;Number of cameras detected: {0}\n\n&quot;</span>, camList.Count);</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Finish if there are no cameras</span></div>
<div class="line">            <span class="keywordflow">if</span> (camList.Count == 0)</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// Clear camera list before releasing system</span></div>
<div class="line">                camList.Clear();</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Release system</span></div>
<div class="line">                system.Dispose();</div>
<div class="line"></div>
<div class="line">                Console.WriteLine(<span class="stringliteral">&quot;Not enough cameras!&quot;</span>);</div>
<div class="line">                Console.WriteLine(<span class="stringliteral">&quot;Done! Press Enter to exit...&quot;</span>);</div>
<div class="line">                Console.ReadLine();</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Run example on each camera</span></div>
<div class="line">            <span class="keywordtype">int</span> index = 0;</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">foreach</span>(IManagedCamera managedCamera <span class="keywordflow">in</span> camList) <span class="keyword">using</span>(managedCamera)</div>
<div class="line">            {</div>
<div class="line">                Console.WriteLine(<span class="stringliteral">&quot;Running example for camera {0}...&quot;</span>, index);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">try</span></div>
<div class="line">                {</div>
<div class="line">                    <span class="comment">// Run example</span></div>
<div class="line">                    result = result | program.RunSingleCamera(managedCamera);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">catch</span> (SpinnakerException ex)</div>
<div class="line">                {</div>
<div class="line">                    Console.WriteLine(<span class="stringliteral">&quot;Error: {0}&quot;</span>, ex.Message);</div>
<div class="line">                    result = -1;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                Console.WriteLine(<span class="stringliteral">&quot;Camera {0} example complete...\n&quot;</span>, index++);</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Clear camera list before releasing system</span></div>
<div class="line">            camList.Clear();</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Release system</span></div>
<div class="line">            system.Dispose();</div>
<div class="line"></div>
<div class="line">            Console.WriteLine(<span class="stringliteral">&quot;\nDone! Press Enter to exit...&quot;</span>);</div>
<div class="line">            Console.ReadLine();</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">return</span> result;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->

  <table style="width: 100%;border-spacing: 0px 0px;border-left-style: solid;border-left-width: ;border-left-color: #8c8888;border-right-style: solid;border-right-width: ;border-right-color: #8c8888;border-top-style: solid;border-top-width: ;border-top-color: #8c8888;border-bottom-style: solid;border-bottom-width: ;border-bottom-color: #8c8888;margin-left: 0;margin-right: auto;padding: 0px">
    <col />
    <col />
    <col />
        <tbody>
            <tr>
                <td style="background-color: #8c8888;color: #ffffff;"><a class="footer" href="https://www.flir.com/support-center/rma/iis-support-request">Contact Support </a> </td>
                <td style="background-color: #8c8888;color: #ffffff;text-align: center;font-size: 16px;font-weight: bold">Spinnaker&#174; SDK Programmer's Guide and API Reference</td>
                <td style="background-color: #8c8888;color: #ffffff;text-align: right;"><address class="footer">
Wed Sep 30 2020 &#160;Â© <a class="footer" href="https://www.flir.com/iis/machine-vision">FLIR Integrated Imaging Solutions Inc. All rights reserved.</a></address></td>
            </tr>
        </tbody>
  </table>
</body>
</html>
